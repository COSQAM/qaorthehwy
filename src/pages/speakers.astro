---
import Layout from '../layouts/Layout.astro';
import SpeakerCard from '../components/SpeakerCard.astro';
import PageHeader from '../components/PageHeader.astro';
import sessionizeData from '../data/sessionize.json';
import { getSpeakerPhaseConfig } from '../config/speakers';

// Get current speaker phase configuration
const speakerPhase = getSpeakerPhaseConfig();

const allSpeakers = sessionizeData.speakers.sort((a: any, b: any) => {
  // Sort keynotes first
  if (a.isTopSpeaker && !b.isTopSpeaker) return -1;
  if (!a.isTopSpeaker && b.isTopSpeaker) return 1;
  // Then alphabetically by full name
  return a.fullName.localeCompare(b.fullName);
});

// Filter speakers based on current phase
const displaySpeakers = speakerPhase.sessionSpeakersCarousel.visible
  ? allSpeakers
  : allSpeakers.filter((speaker: any) => speaker.isTopSpeaker);
---

<Layout title="Speakers - QA or the Highway">
  <main>
    <PageHeader
      title="Our Speakers"
      description="Learn from industry experts and thought leaders in quality engineering and testing."
    />

    <section class="py-16 px-4">
      <div class="container mx-auto max-w-6xl">
        {displaySpeakers.length > 0 ? (
          <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-8">
            {displaySpeakers.map((speaker: any) => {
              const slug = `${speaker.firstName.toLowerCase()}-${speaker.lastName.toLowerCase()}`;
              return (
                <SpeakerCard
                  name={speaker.fullName}
                  tagLine={speaker.tagLine}
                  profilePicture={speaker.profilePicture}
                  links={speaker.links}
                  speakerSlug={slug}
                  isKeynote={speaker.isTopSpeaker}
                />
              );
            })}
          </div>
        ) : (
          <div class="text-center py-12">
            <p class="text-xl text-gray-600 mb-4">Speakers will be announced soon!</p>
            <p class="text-gray-500">Check back later for updates.</p>
          </div>
        )}
        {speakerPhase.speakersPage.message && displaySpeakers.length > 0 && (
          <div class="text-center py-8 mt-8">
            <p class="text-lg text-gray-600">{speakerPhase.speakersPage.message}</p>
          </div>
        )}
      </div>
    </section>
  </main>
</Layout>
