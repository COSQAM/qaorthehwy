---
import Layout from "../layouts/Layout.astro";
import Hero from "../components/Hero.astro";
import SpeakerCard from "../components/SpeakerCard.astro";
import SpeakerCarousel from "../components/SpeakerCarousel.astro";
import WhyAttend from "../components/WhyAttend.astro";
import Tickets from "../components/Tickets.astro";
import Sponsors from "../components/Sponsors.astro";
import AnnouncementBanner from "../components/AnnouncementBanner.astro";
import sessionizeData from "../data/sessionize.json";
import { getSpeakerPhaseConfig } from "../config/speakers";
import {
  getCallForSpeakersConfig,
  getFeedbackConfig,
} from "../config/announcements";

const conferenceData = {
  date: "June 12, 2026",
  venue: "The Ohio Union",
  location: "Columbus, OH",
  sessionsCount: "32 Sessions",
  description:
    "Join us for a day of insightful talks and networking with industry leaders in software quality.",
  attendees: "400+",
};

// Get current speaker phase configuration
const speakerPhase = getSpeakerPhaseConfig();

// Get announcement banner configurations
const cfpConfig = getCallForSpeakersConfig();
const feedbackConfig = getFeedbackConfig();

// Keynote speakers from Sessionize data
const keynoteSpeakers = sessionizeData.speakers
  .filter((speaker: any) => speaker.isTopSpeaker)
  .slice(0, 2);

// Non-keynote speakers for carousel
const nonKeynoteSpeakers = sessionizeData.speakers.filter(
  (speaker: any) => !speaker.isTopSpeaker,
);

// All speakers from Sessionize
const allSpeakers = sessionizeData.speakers;
---

<Layout title="QA or the Highway - Quality Engineering Conference">
  <Hero
    date={conferenceData.date}
    location={conferenceData.location}
    venue={conferenceData.venue}
    description={conferenceData.description}
    attendees={conferenceData.attendees}
    videoSrc={`${import.meta.env.BASE_URL}/hero-video.webm`}
  />

  <!-- Feedback Banner -->
  {
    feedbackConfig.enabled && (
      <AnnouncementBanner
        title={feedbackConfig.title}
        description={feedbackConfig.description}
        ctaText={feedbackConfig.ctaText}
        ctaUrl={feedbackConfig.ctaUrl}
        openInNewTab={feedbackConfig.openInNewTab}
      />
    )
  }

  <!-- Call for Speakers Banner -->
  {
    cfpConfig.enabled && (
      <AnnouncementBanner
        title={cfpConfig.title}
        description={cfpConfig.description}
        ctaText={cfpConfig.ctaText}
        ctaUrl={cfpConfig.ctaUrl}
        deadline={cfpConfig.deadline}
        openInNewTab={cfpConfig.openInNewTab}
      />
    )
  }
  <!-- Keynote Speakers Preview -->
  {
    speakerPhase.keynotesSection.visible && keynoteSpeakers.length > 0 && (
      <section id="keynotes" class="section-light py-24 px-6">
        <div class="container mx-auto max-w-3xl">
          <h2 class="text-5xl md:text-6xl font-bold text-center mb-20 tracking-tight">
            KEYNOTE SPEAKERS
          </h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-12 max-w-5xl mx-auto">
            {keynoteSpeakers.map((speaker: any) => (
              <SpeakerCard
                name={speaker.fullName}
                tagLine={speaker.tagLine}
                profilePicture={speaker.profilePicture}
              />
            ))}
          </div>
        </div>
      </section>
    )
  }

  <!-- Speaker Carousel -->
  {
    speakerPhase.sessionSpeakersCarousel.visible &&
      nonKeynoteSpeakers.length > 0 && (
        <section id="speakers-carousel" class="section-light py-8 px-6">
          <div class="container mx-auto max-w-7xl">
            <h2 class="text-5xl md:text-6xl font-bold text-center mb-20 tracking-tight">
              SESSION SPEAKERS
            </h2>
            <SpeakerCarousel speakers={nonKeynoteSpeakers} />
          </div>
        </section>
      )
  }

  <!-- Why Attend Section -->
  <WhyAttend />

  <!-- Tickets Section -->
  <Tickets />

  <!-- Sponsors Section -->
  <Sponsors />
</Layout>
